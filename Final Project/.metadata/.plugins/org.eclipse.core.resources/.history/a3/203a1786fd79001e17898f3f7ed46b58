package com.java.jsp;

import java.util.regex.Pattern;

import javax.faces.application.FacesMessage;
import javax.faces.context.FacesContext;

public class PatientController {
	
	private Patient patient;
	private PatientDaoImpl daoImpl;
	
	
	public Patient getPatient() {
		return patient;
	}
	public void setPatient(Patient patient) {
		this.patient = patient;
	}
	public PatientDaoImpl getDaoImpl() {
		return daoImpl;
	}
	public void setDaoImpl(PatientDaoImpl daoImpl) {
		this.daoImpl = daoImpl;
	}
	
	public String addPatientValid() {
		System.out.println("addPatientValid is Hittingggggggggg");
		if(addValid()) {
			return daoImpl.addPatient(patient);
		}
		return "";
	
	}
	
	
public boolean addValid() {
	FacesContext context = FacesContext.getCurrentInstance();
	String firstName = "^[A-Za-z\\s]+$";
	String lastName =  "^[A-Za-z\\s]+$";
	String userName =  "^[^\\s]{8,10}$";
	String phoneno = "^(\\+91|91|0)?[6789]\\d{9}$";
	String email = "^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$";

	
	 if(!Pattern.matches(userName, patient.getUserName())) {
		 context.addMessage("form:userName", new FacesMessage("Invalid Username. It should be 8-10 characters without spaces."));
		 return false;
	 }
	 if(!Pattern.matches(firstName, patient.getFirstName())) {
		 context.addMessage("form:firstName", new FacesMessage("Invalid FirstName. Only letters are allowed."));
		 return false;
	 }
	 if(!Pattern.matches(lastName, patient.getLastName())) {
		 context.addMessage("form:lastName", new FacesMessage("Invalid LastName. Only letters are allowed."));
		 return false;
	 }
	 if(!Pattern.matches(phoneno, patient.getPhoneno())) {
		 context.addMessage("form:phoneno", new FacesMessage("Invalid Phone Number."));
		 return false;
	 }
	 if(!Pattern.matches(email, patient.getEmail())) {
		 context.addMessage("form:email", new FacesMessage("Invalid Email."));
		 return false;
	 }
	 return true;
}
}
