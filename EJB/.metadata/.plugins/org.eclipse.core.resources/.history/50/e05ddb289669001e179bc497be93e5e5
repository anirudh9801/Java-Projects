package com.java.ejb;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.List;

public class EmployDAOImpl {

    private PreparedStatement pst;
    private Connection connection;

    public List<Employ> showEmployDao() throws ClassNotFoundException, SQLException {

        connection = ConnectionHelper.getConnection();
        String cmd = "SELECT * FROM Employ";
        pst = connection.prepareStatement(cmd);
        ResultSet rs = pst.executeQuery();

        List<Employ> employList = new ArrayList<>(); // Use ArrayList to implement the List interface

        while (rs.next()) {
            Employ employ = new Employ();

            employ.setEmpno(rs.getInt("empno"));
            employ.setName(rs.getString("name"));
            employ.setGender(Gender.valueOf(rs.getString("gender")));
            employ.setDept(rs.getString("dept"));
            employ.setDesig(rs.getString("desig"));
            employ.setBasic(rs.getDouble("basic"));

            employList.add(employ);
        }

        // Close the resources
        if (rs != null) {
            rs.close();
        }
        if (pst != null) {
            pst.close();
        }
        if (connection != null) {
            connection.close();
        }

        return employList;
    }
}
